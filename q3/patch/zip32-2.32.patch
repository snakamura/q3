diff -uNr zip32-2.32.orig/windll/visualc/dll/zip32.mak zip32-2.32/windll/visualc/dll/zip32.mak
--- zip32-2.32.orig/windll/visualc/dll/zip32.mak	1999-01-14 15:38:32.000000000 +0900
+++ zip32-2.32/windll/visualc/dll/zip32.mak	2006-08-09 19:23:11.377344200 +0900
@@ -55,7 +55,7 @@
 	-@erase "$(INTDIR)\trees.obj"
 	-@erase "$(INTDIR)\ttyio.obj"
 	-@erase "$(INTDIR)\util.obj"
-	-@erase "$(INTDIR)\vc50.idb"
+	-@erase "$(INTDIR)\vc80.idb"
 	-@erase "$(INTDIR)\win32.obj"
 	-@erase "$(INTDIR)\win32zip.obj"
 	-@erase "$(INTDIR)\windll.obj"
@@ -74,8 +74,8 @@
     if not exist "$(INTDIR)/$(NULL)" mkdir "$(INTDIR)"
 
 CPP=cl.exe
-CPP_PROJ=/nologo /Zp4 /MT /W3 /GX /O2 /I "..\..\.." /I "..\..\..\WINDLL" /I "..\..\..\WIN32" /D "NDEBUG" /D "_WINDOWS" /D "WIN32" /D "NO_ASM" /D "WINDLL" /D\
- "MSDOS" /D "USE_ZIPMAIN" /Fp"$(INTDIR)\zip32.pch" /YX\
+CPP_PROJ=/nologo /Zp4 /MD /W3 /EHsc /O2 /I "..\..\.." /I "..\..\..\WINDLL" /I "..\..\..\WIN32" /D "NDEBUG" /D "_WINDOWS" /D "WIN32" /D "NO_ASM" /D "WINDLL" /D\
+ "MSDOS" /D "USE_ZIPMAIN"\
  /Fo"$(INTDIR)\\" /Fd"$(INTDIR)\\" /FD /c
 CPP_OBJS=.\Release/
 CPP_SBRS=.
@@ -181,8 +181,8 @@
 	-@erase "$(INTDIR)\trees.obj"
 	-@erase "$(INTDIR)\ttyio.obj"
 	-@erase "$(INTDIR)\util.obj"
-	-@erase "$(INTDIR)\vc50.idb"
-	-@erase "$(INTDIR)\vc50.pdb"
+	-@erase "$(INTDIR)\vc80.idb"
+	-@erase "$(INTDIR)\vc80.pdb"
 	-@erase "$(INTDIR)\win32.obj"
 	-@erase "$(INTDIR)\win32zip.obj"
 	-@erase "$(INTDIR)\windll.obj"
@@ -203,10 +203,10 @@
     if not exist "$(INTDIR)/$(NULL)" mkdir "$(INTDIR)"
 
 CPP=cl.exe
-CPP_PROJ=/nologo /Zp4 /MTd /W3 /Gm /GX /Zi /Od /I "..\..\.." /I\
+CPP_PROJ=/nologo /Zp4 /MDd /W3 /Gm /EHsc /Zi /Od /I "..\..\.." /I\
  "..\..\..\WINDLL" /I "..\..\..\WIN32" /D "_DEBUG" /D "_WINDOWS" /D "WIN32" /D\
  "NO_ASM" /D "WINDLL" /D "MSDOS" /D "USE_ZIPMAIN"\
- /Fp"$(INTDIR)\zip32.pch" /YX /Fo"$(INTDIR)\\" /Fd"$(INTDIR)\\" /FD /c
+ /Fo"$(INTDIR)\\" /Fd"$(INTDIR)\\" /FD /c
 CPP_OBJS=.\Debug/
 CPP_SBRS=.
 
@@ -253,7 +253,7 @@
  /nologo /subsystem:windows /dll /incremental:yes\
  /pdb:"$(OUTDIR)\zip32.pdb" /debug /machine:I386\
  /def:"..\..\..\windll\windll32.def" /out:"$(OUTDIR)\zip32.dll"\
- /implib:"$(OUTDIR)\zip32.lib" /pdbtype:sept
+ /implib:"$(OUTDIR)\zip32.lib"
 DEF_FILE= \
 	"..\..\..\windll\windll32.def"
 LINK32_OBJS= \
@@ -285,7 +285,7 @@
 
 
 !IF "$(CFG)" == "zip32 - Win32 Release" || "$(CFG)" == "zip32 - Win32 Debug"
-SOURCE=D:\wiz\zip\api.c
+SOURCE=..\..\..\api.c
 DEP_CPP_API_C=\
 	"..\..\..\api.h"\
 	"..\..\..\crypt.h"\
@@ -302,7 +302,7 @@
 	$(CPP) $(CPP_PROJ) $(SOURCE)
 
 
-SOURCE=D:\wiz\zip\crc32.c
+SOURCE=..\..\..\crc32.c
 
 !IF  "$(CFG)" == "zip32 - Win32 Release"
 
@@ -334,7 +334,7 @@
 
 !ENDIF
 
-SOURCE=D:\wiz\zip\crctab.c
+SOURCE=..\..\..\crctab.c
 
 !IF  "$(CFG)" == "zip32 - Win32 Release"
 
@@ -366,7 +366,7 @@
 
 !ENDIF
 
-SOURCE=D:\wiz\zip\crypt.c
+SOURCE=..\..\..\crypt.c
 
 !IF  "$(CFG)" == "zip32 - Win32 Release"
 
@@ -402,7 +402,7 @@
 
 !ENDIF
 
-SOURCE=D:\wiz\zip\deflate.c
+SOURCE=..\..\..\deflate.c
 
 !IF  "$(CFG)" == "zip32 - Win32 Release"
 
@@ -434,7 +434,7 @@
 
 !ENDIF
 
-SOURCE=D:\wiz\zip\fileio.c
+SOURCE=..\..\..\fileio.c
 
 !IF  "$(CFG)" == "zip32 - Win32 Release"
 
@@ -466,7 +466,7 @@
 
 !ENDIF
 
-SOURCE=D:\wiz\zip\globals.c
+SOURCE=..\..\..\globals.c
 
 !IF  "$(CFG)" == "zip32 - Win32 Release"
 
@@ -498,7 +498,7 @@
 
 !ENDIF
 
-SOURCE=D:\wiz\zip\Win32\nt.c
+SOURCE=..\..\..\Win32\nt.c
 
 !IF  "$(CFG)" == "zip32 - Win32 Release"
 
@@ -532,7 +532,7 @@
 
 !ENDIF
 
-SOURCE=D:\wiz\zip\trees.c
+SOURCE=..\..\..\trees.c
 
 !IF  "$(CFG)" == "zip32 - Win32 Release"
 
@@ -564,7 +564,7 @@
 
 !ENDIF
 
-SOURCE=D:\wiz\zip\ttyio.c
+SOURCE=..\..\..\ttyio.c
 
 !IF  "$(CFG)" == "zip32 - Win32 Release"
 
@@ -600,7 +600,7 @@
 
 !ENDIF
 
-SOURCE=D:\wiz\zip\util.c
+SOURCE=..\..\..\util.c
 
 !IF  "$(CFG)" == "zip32 - Win32 Release"
 
@@ -634,7 +634,7 @@
 
 !ENDIF
 
-SOURCE=D:\wiz\zip\Win32\win32.c
+SOURCE=..\..\..\Win32\win32.c
 
 !IF  "$(CFG)" == "zip32 - Win32 Release"
 
@@ -668,7 +668,7 @@
 
 !ENDIF
 
-SOURCE=D:\wiz\zip\Win32\win32zip.c
+SOURCE=..\..\..\Win32\win32zip.c
 
 !IF  "$(CFG)" == "zip32 - Win32 Release"
 
@@ -704,7 +704,7 @@
 
 !ENDIF
 
-SOURCE=D:\wiz\zip\windll\windll.c
+SOURCE=..\..\..\windll\windll.c
 DEP_CPP_WINDL=\
 	"..\..\..\api.h"\
 	"..\..\..\tailor.h"\
@@ -719,13 +719,13 @@
 	$(CPP) $(CPP_PROJ) $(SOURCE)
 
 
-SOURCE=D:\wiz\zip\windll\windll.rc
+SOURCE=..\..\..\windll\windll.rc
 
 !IF  "$(CFG)" == "zip32 - Win32 Release"
 
 
 "$(INTDIR)\windll.res" : $(SOURCE) "$(INTDIR)"
-	$(RSC) /l 0x409 /fo"$(INTDIR)\windll.res" /i "\wiz\zip\windll" /d "NDEBUG" /d\
+	$(RSC) /l 0x409 /fo"$(INTDIR)\windll.res" /i "\temp\zip-232\windll" /d "NDEBUG" /d\
  "WIN32" $(SOURCE)
 
 
@@ -733,13 +733,13 @@
 
 
 "$(INTDIR)\windll.res" : $(SOURCE) "$(INTDIR)"
-	$(RSC) /l 0x409 /fo"$(INTDIR)\windll.res" /i "\wiz\zip\windll" /d "_DEBUG" /d\
+	$(RSC) /l 0x409 /fo"$(INTDIR)\windll.res" /i "\temp\zip-232\windll" /d "_DEBUG" /d\
  "WIN32" $(SOURCE)
 
 
 !ENDIF
 
-SOURCE=D:\wiz\zip\zip.c
+SOURCE=..\..\..\zip.c
 
 !IF  "$(CFG)" == "zip32 - Win32 Release"
 
@@ -781,7 +781,7 @@
 
 !ENDIF
 
-SOURCE=D:\wiz\zip\zipfile.c
+SOURCE=..\..\..\zipfile.c
 
 !IF  "$(CFG)" == "zip32 - Win32 Release"
 
@@ -815,7 +815,7 @@
 
 !ENDIF
 
-SOURCE=D:\wiz\zip\zipup.c
+SOURCE=..\..\..\zipup.c
 
 !IF  "$(CFG)" == "zip32 - Win32 Release"
 
diff -uNr zip32-2.32.orig/windll/visualc/dll/zip32_64.mak zip32-2.32/windll/visualc/dll/zip32_64.mak
--- zip32-2.32.orig/windll/visualc/dll/zip32_64.mak	1970-01-01 09:00:00.000000000 +0900
+++ zip32-2.32/windll/visualc/dll/zip32_64.mak	2006-08-09 19:27:44.931352000 +0900
@@ -0,0 +1,858 @@
+# Microsoft Developer Studio Generated NMAKE File, Based on zip32.dsp
+!IF "$(CFG)" == ""
+CFG=zip32 - Win32 Debug
+!MESSAGE No configuration specified. Defaulting to zip32 - Win32 Debug.
+!ENDIF
+
+!IF "$(CFG)" != "zip32 - Win32 Release" && "$(CFG)" != "zip32 - Win32 Debug"
+!MESSAGE Invalid configuration "$(CFG)" specified.
+!MESSAGE You can specify a configuration when running NMAKE
+!MESSAGE by defining the macro CFG on the command line. For example:
+!MESSAGE
+!MESSAGE NMAKE /f "zip32.mak" CFG="zip32 - Win32 Debug"
+!MESSAGE
+!MESSAGE Possible choices for configuration are:
+!MESSAGE
+!MESSAGE "zip32 - Win32 Release" (based on "Win32 (x86) Dynamic-Link Library")
+!MESSAGE "zip32 - Win32 Debug" (based on "Win32 (x86) Dynamic-Link Library")
+!MESSAGE
+!ERROR An invalid configuration is specified.
+!ENDIF
+
+!IF "$(OS)" == "Windows_NT"
+NULL=
+!ELSE
+NULL=nul
+!ENDIF
+
+!IF  "$(CFG)" == "zip32 - Win32 Release"
+
+OUTDIR=.\..\Release64\app
+INTDIR=.\Release64
+# Begin Custom Macros
+OutDir=.\..\Release64\app
+# End Custom Macros
+
+!IF "$(RECURSE)" == "0"
+
+ALL : "$(OUTDIR)\zip32.dll"
+
+!ELSE
+
+ALL : "$(OUTDIR)\zip32.dll"
+
+!ENDIF
+
+CLEAN :
+	-@erase "$(INTDIR)\api.obj"
+	-@erase "$(INTDIR)\crc32.obj"
+	-@erase "$(INTDIR)\crctab.obj"
+	-@erase "$(INTDIR)\crypt.obj"
+	-@erase "$(INTDIR)\deflate.obj"
+	-@erase "$(INTDIR)\fileio.obj"
+	-@erase "$(INTDIR)\globals.obj"
+	-@erase "$(INTDIR)\nt.obj"
+	-@erase "$(INTDIR)\trees.obj"
+	-@erase "$(INTDIR)\ttyio.obj"
+	-@erase "$(INTDIR)\util.obj"
+	-@erase "$(INTDIR)\vc80.idb"
+	-@erase "$(INTDIR)\win32.obj"
+	-@erase "$(INTDIR)\win32zip.obj"
+	-@erase "$(INTDIR)\windll.obj"
+	-@erase "$(INTDIR)\windll.res"
+	-@erase "$(INTDIR)\zip.obj"
+	-@erase "$(INTDIR)\zipfile.obj"
+	-@erase "$(INTDIR)\zipup.obj"
+	-@erase "$(OUTDIR)\zip32.dll"
+	-@erase "$(OUTDIR)\zip32.exp"
+	-@erase "$(OUTDIR)\zip32.lib"
+
+"$(OUTDIR)" :
+    if not exist "$(OUTDIR)/$(NULL)" mkdir "$(OUTDIR)"
+
+"$(INTDIR)" :
+    if not exist "$(INTDIR)/$(NULL)" mkdir "$(INTDIR)"
+
+CPP=cl.exe
+CPP_PROJ=/nologo /Zp4 /MD /W3 /EHsc /O2 /I "..\..\.." /I "..\..\..\WINDLL" /I "..\..\..\WIN32" /D "NDEBUG" /D "_WINDOWS" /D "WIN32" /D "NO_ASM" /D "WINDLL" /D\
+ "MSDOS" /D "USE_ZIPMAIN"\
+ /Fo"$(INTDIR)\\" /Fd"$(INTDIR)\\" /FD /c
+CPP_OBJS=.\Release64/
+CPP_SBRS=.
+
+.c{$(CPP_OBJS)}.obj::
+   $(CPP) @<<
+   $(CPP_PROJ) $<
+<<
+
+.cpp{$(CPP_OBJS)}.obj::
+   $(CPP) @<<
+   $(CPP_PROJ) $<
+<<
+
+.cxx{$(CPP_OBJS)}.obj::
+   $(CPP) @<<
+   $(CPP_PROJ) $<
+<<
+
+.c{$(CPP_SBRS)}.sbr::
+   $(CPP) @<<
+   $(CPP_PROJ) $<
+<<
+
+.cpp{$(CPP_SBRS)}.sbr::
+   $(CPP) @<<
+   $(CPP_PROJ) $<
+<<
+
+.cxx{$(CPP_SBRS)}.sbr::
+   $(CPP) @<<
+   $(CPP_PROJ) $<
+<<
+
+MTL=midl.exe
+MTL_PROJ=/nologo /D "NDEBUG" /mktyplib203 /o NUL /win32
+RSC=rc.exe
+RSC_PROJ=/l 0x409 /fo"$(INTDIR)\windll.res" /d "NDEBUG" /d "WIN32"
+BSC32=bscmake.exe
+BSC32_FLAGS=/nologo /o"$(OUTDIR)\zip32.bsc"
+BSC32_SBRS= \
+
+LINK32=link.exe
+LINK32_FLAGS=kernel32.lib user32.lib advapi32.lib\
+ /nologo /subsystem:windows /dll /incremental:no\
+ /pdb:"$(OUTDIR)\zip32.pdb" /machine:X64\
+ /def:"..\..\..\windll\windll32.def" /out:"$(OUTDIR)\zip32.dll"\
+ /implib:"$(OUTDIR)\zip32.lib"
+DEF_FILE= \
+	"..\..\..\windll\windll32.def"
+LINK32_OBJS= \
+	"$(INTDIR)\api.obj" \
+	"$(INTDIR)\crc32.obj" \
+	"$(INTDIR)\crctab.obj" \
+	"$(INTDIR)\crypt.obj" \
+	"$(INTDIR)\deflate.obj" \
+	"$(INTDIR)\fileio.obj" \
+	"$(INTDIR)\globals.obj" \
+	"$(INTDIR)\nt.obj" \
+	"$(INTDIR)\trees.obj" \
+	"$(INTDIR)\ttyio.obj" \
+	"$(INTDIR)\util.obj" \
+	"$(INTDIR)\win32.obj" \
+	"$(INTDIR)\win32zip.obj" \
+	"$(INTDIR)\windll.obj" \
+	"$(INTDIR)\windll.res" \
+	"$(INTDIR)\zip.obj" \
+	"$(INTDIR)\zipfile.obj" \
+	"$(INTDIR)\zipup.obj"
+
+"$(OUTDIR)\zip32.dll" : "$(OUTDIR)" $(DEF_FILE) $(LINK32_OBJS)
+    $(LINK32) @<<
+  $(LINK32_FLAGS) $(LINK32_OBJS)
+<<
+
+!ELSEIF  "$(CFG)" == "zip32 - Win32 Debug"
+
+OUTDIR=.\..\Debug64\app
+INTDIR=.\Debug64
+# Begin Custom Macros
+OutDir=.\..\Debug64\app
+# End Custom Macros
+
+!IF "$(RECURSE)" == "0"
+
+ALL : "$(OUTDIR)\zip32.dll"
+
+!ELSE
+
+ALL : "$(OUTDIR)\zip32.dll"
+
+!ENDIF
+
+CLEAN :
+	-@erase "$(INTDIR)\api.obj"
+	-@erase "$(INTDIR)\crc32.obj"
+	-@erase "$(INTDIR)\crctab.obj"
+	-@erase "$(INTDIR)\crypt.obj"
+	-@erase "$(INTDIR)\deflate.obj"
+	-@erase "$(INTDIR)\fileio.obj"
+	-@erase "$(INTDIR)\globals.obj"
+	-@erase "$(INTDIR)\nt.obj"
+	-@erase "$(INTDIR)\trees.obj"
+	-@erase "$(INTDIR)\ttyio.obj"
+	-@erase "$(INTDIR)\util.obj"
+	-@erase "$(INTDIR)\vc80.idb"
+	-@erase "$(INTDIR)\vc80.pdb"
+	-@erase "$(INTDIR)\win32.obj"
+	-@erase "$(INTDIR)\win32zip.obj"
+	-@erase "$(INTDIR)\windll.obj"
+	-@erase "$(INTDIR)\windll.res"
+	-@erase "$(INTDIR)\zip.obj"
+	-@erase "$(INTDIR)\zipfile.obj"
+	-@erase "$(INTDIR)\zipup.obj"
+	-@erase "$(OUTDIR)\zip32.dll"
+	-@erase "$(OUTDIR)\zip32.exp"
+	-@erase "$(OUTDIR)\zip32.ilk"
+	-@erase "$(OUTDIR)\zip32.lib"
+	-@erase "$(OUTDIR)\zip32.pdb"
+
+"$(OUTDIR)" :
+    if not exist "$(OUTDIR)/$(NULL)" mkdir "$(OUTDIR)"
+
+"$(INTDIR)" :
+    if not exist "$(INTDIR)/$(NULL)" mkdir "$(INTDIR)"
+
+CPP=cl.exe
+CPP_PROJ=/nologo /Zp4 /MDd /W3 /Gm /EHsc /Zi /Od /I "..\..\.." /I\
+ "..\..\..\WINDLL" /I "..\..\..\WIN32" /D "_DEBUG" /D "_WINDOWS" /D "WIN32" /D\
+ "NO_ASM" /D "WINDLL" /D "MSDOS" /D "USE_ZIPMAIN"\
+ /Fo"$(INTDIR)\\" /Fd"$(INTDIR)\\" /FD /c
+CPP_OBJS=.\Debug64/
+CPP_SBRS=.
+
+.c{$(CPP_OBJS)}.obj::
+   $(CPP) @<<
+   $(CPP_PROJ) $<
+<<
+
+.cpp{$(CPP_OBJS)}.obj::
+   $(CPP) @<<
+   $(CPP_PROJ) $<
+<<
+
+.cxx{$(CPP_OBJS)}.obj::
+   $(CPP) @<<
+   $(CPP_PROJ) $<
+<<
+
+.c{$(CPP_SBRS)}.sbr::
+   $(CPP) @<<
+   $(CPP_PROJ) $<
+<<
+
+.cpp{$(CPP_SBRS)}.sbr::
+   $(CPP) @<<
+   $(CPP_PROJ) $<
+<<
+
+.cxx{$(CPP_SBRS)}.sbr::
+   $(CPP) @<<
+   $(CPP_PROJ) $<
+<<
+
+MTL=midl.exe
+MTL_PROJ=/nologo /D "_DEBUG" /mktyplib203 /o NUL /win32
+RSC=rc.exe
+RSC_PROJ=/l 0x409 /fo"$(INTDIR)\windll.res" /d "_DEBUG" /d "WIN32"
+BSC32=bscmake.exe
+BSC32_FLAGS=/nologo /o"$(OUTDIR)\zip32.bsc"
+BSC32_SBRS= \
+
+LINK32=link.exe
+LINK32_FLAGS=kernel32.lib user32.lib advapi32.lib\
+ /nologo /subsystem:windows /dll /incremental:yes\
+ /pdb:"$(OUTDIR)\zip32.pdb" /debug /machine:X64\
+ /def:"..\..\..\windll\windll32.def" /out:"$(OUTDIR)\zip32.dll"\
+ /implib:"$(OUTDIR)\zip32.lib"
+DEF_FILE= \
+	"..\..\..\windll\windll32.def"
+LINK32_OBJS= \
+	"$(INTDIR)\api.obj" \
+	"$(INTDIR)\crc32.obj" \
+	"$(INTDIR)\crctab.obj" \
+	"$(INTDIR)\crypt.obj" \
+	"$(INTDIR)\deflate.obj" \
+	"$(INTDIR)\fileio.obj" \
+	"$(INTDIR)\globals.obj" \
+	"$(INTDIR)\nt.obj" \
+	"$(INTDIR)\trees.obj" \
+	"$(INTDIR)\ttyio.obj" \
+	"$(INTDIR)\util.obj" \
+	"$(INTDIR)\win32.obj" \
+	"$(INTDIR)\win32zip.obj" \
+	"$(INTDIR)\windll.obj" \
+	"$(INTDIR)\windll.res" \
+	"$(INTDIR)\zip.obj" \
+	"$(INTDIR)\zipfile.obj" \
+	"$(INTDIR)\zipup.obj"
+
+"$(OUTDIR)\zip32.dll" : "$(OUTDIR)" $(DEF_FILE) $(LINK32_OBJS)
+    $(LINK32) @<<
+  $(LINK32_FLAGS) $(LINK32_OBJS)
+<<
+
+!ENDIF
+
+
+!IF "$(CFG)" == "zip32 - Win32 Release" || "$(CFG)" == "zip32 - Win32 Debug"
+SOURCE=..\..\..\api.c
+DEP_CPP_API_C=\
+	"..\..\..\api.h"\
+	"..\..\..\crypt.h"\
+	"..\..\..\revision.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\windll\structs.h"\
+	"..\..\..\windll\windll.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\api.obj" : $(SOURCE) $(DEP_CPP_API_C) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+SOURCE=..\..\..\crc32.c
+
+!IF  "$(CFG)" == "zip32 - Win32 Release"
+
+DEP_CPP_CRC32=\
+	"..\..\..\api.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\crc32.obj" : $(SOURCE) $(DEP_CPP_CRC32) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ELSEIF  "$(CFG)" == "zip32 - Win32 Debug"
+
+DEP_CPP_CRC32=\
+	"..\..\..\api.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\crc32.obj" : $(SOURCE) $(DEP_CPP_CRC32) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ENDIF
+
+SOURCE=..\..\..\crctab.c
+
+!IF  "$(CFG)" == "zip32 - Win32 Release"
+
+DEP_CPP_CRCTA=\
+	"..\..\..\api.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\crctab.obj" : $(SOURCE) $(DEP_CPP_CRCTA) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ELSEIF  "$(CFG)" == "zip32 - Win32 Debug"
+
+DEP_CPP_CRCTA=\
+	"..\..\..\api.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\crctab.obj" : $(SOURCE) $(DEP_CPP_CRCTA) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ENDIF
+
+SOURCE=..\..\..\crypt.c
+
+!IF  "$(CFG)" == "zip32 - Win32 Release"
+
+DEP_CPP_CRYPT=\
+	"..\..\..\api.h"\
+	"..\..\..\crypt.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\ttyio.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\crypt.obj" : $(SOURCE) $(DEP_CPP_CRYPT) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ELSEIF  "$(CFG)" == "zip32 - Win32 Debug"
+
+DEP_CPP_CRYPT=\
+	"..\..\..\api.h"\
+	"..\..\..\crypt.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\ttyio.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\crypt.obj" : $(SOURCE) $(DEP_CPP_CRYPT) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ENDIF
+
+SOURCE=..\..\..\deflate.c
+
+!IF  "$(CFG)" == "zip32 - Win32 Release"
+
+DEP_CPP_DEFLA=\
+	"..\..\..\api.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\deflate.obj" : $(SOURCE) $(DEP_CPP_DEFLA) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ELSEIF  "$(CFG)" == "zip32 - Win32 Debug"
+
+DEP_CPP_DEFLA=\
+	"..\..\..\api.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\deflate.obj" : $(SOURCE) $(DEP_CPP_DEFLA) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ENDIF
+
+SOURCE=..\..\..\fileio.c
+
+!IF  "$(CFG)" == "zip32 - Win32 Release"
+
+DEP_CPP_FILEI=\
+	"..\..\..\api.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\fileio.obj" : $(SOURCE) $(DEP_CPP_FILEI) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ELSEIF  "$(CFG)" == "zip32 - Win32 Debug"
+
+DEP_CPP_FILEI=\
+	"..\..\..\api.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\fileio.obj" : $(SOURCE) $(DEP_CPP_FILEI) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ENDIF
+
+SOURCE=..\..\..\globals.c
+
+!IF  "$(CFG)" == "zip32 - Win32 Release"
+
+DEP_CPP_GLOBA=\
+	"..\..\..\api.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\globals.obj" : $(SOURCE) $(DEP_CPP_GLOBA) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ELSEIF  "$(CFG)" == "zip32 - Win32 Debug"
+
+DEP_CPP_GLOBA=\
+	"..\..\..\api.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\globals.obj" : $(SOURCE) $(DEP_CPP_GLOBA) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ENDIF
+
+SOURCE=..\..\..\Win32\nt.c
+
+!IF  "$(CFG)" == "zip32 - Win32 Release"
+
+DEP_CPP_NT_C10=\
+	"..\..\..\api.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\nt.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\nt.obj" : $(SOURCE) $(DEP_CPP_NT_C10) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ELSEIF  "$(CFG)" == "zip32 - Win32 Debug"
+
+DEP_CPP_NT_C10=\
+	"..\..\..\api.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\nt.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\nt.obj" : $(SOURCE) $(DEP_CPP_NT_C10) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ENDIF
+
+SOURCE=..\..\..\trees.c
+
+!IF  "$(CFG)" == "zip32 - Win32 Release"
+
+DEP_CPP_TREES=\
+	"..\..\..\api.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\trees.obj" : $(SOURCE) $(DEP_CPP_TREES) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ELSEIF  "$(CFG)" == "zip32 - Win32 Debug"
+
+DEP_CPP_TREES=\
+	"..\..\..\api.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\trees.obj" : $(SOURCE) $(DEP_CPP_TREES) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ENDIF
+
+SOURCE=..\..\..\ttyio.c
+
+!IF  "$(CFG)" == "zip32 - Win32 Release"
+
+DEP_CPP_TTYIO=\
+	"..\..\..\api.h"\
+	"..\..\..\crypt.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\ttyio.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\ttyio.obj" : $(SOURCE) $(DEP_CPP_TTYIO) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ELSEIF  "$(CFG)" == "zip32 - Win32 Debug"
+
+DEP_CPP_TTYIO=\
+	"..\..\..\api.h"\
+	"..\..\..\crypt.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\ttyio.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\ttyio.obj" : $(SOURCE) $(DEP_CPP_TTYIO) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ENDIF
+
+SOURCE=..\..\..\util.c
+
+!IF  "$(CFG)" == "zip32 - Win32 Release"
+
+DEP_CPP_UTIL_=\
+	"..\..\..\api.h"\
+	"..\..\..\ebcdic.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\util.obj" : $(SOURCE) $(DEP_CPP_UTIL_) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ELSEIF  "$(CFG)" == "zip32 - Win32 Debug"
+
+DEP_CPP_UTIL_=\
+	"..\..\..\api.h"\
+	"..\..\..\ebcdic.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\util.obj" : $(SOURCE) $(DEP_CPP_UTIL_) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ENDIF
+
+SOURCE=..\..\..\Win32\win32.c
+
+!IF  "$(CFG)" == "zip32 - Win32 Release"
+
+DEP_CPP_WIN32=\
+	"..\..\..\api.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\win32\win32zip.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\win32.obj" : $(SOURCE) $(DEP_CPP_WIN32) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ELSEIF  "$(CFG)" == "zip32 - Win32 Debug"
+
+DEP_CPP_WIN32=\
+	"..\..\..\api.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\win32\win32zip.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\win32.obj" : $(SOURCE) $(DEP_CPP_WIN32) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ENDIF
+
+SOURCE=..\..\..\Win32\win32zip.c
+
+!IF  "$(CFG)" == "zip32 - Win32 Release"
+
+DEP_CPP_WIN32Z=\
+	"..\..\..\api.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\nt.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\win32\win32zip.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\win32zip.obj" : $(SOURCE) $(DEP_CPP_WIN32Z) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ELSEIF  "$(CFG)" == "zip32 - Win32 Debug"
+
+DEP_CPP_WIN32Z=\
+	"..\..\..\api.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\nt.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\win32\win32zip.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\win32zip.obj" : $(SOURCE) $(DEP_CPP_WIN32Z) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ENDIF
+
+SOURCE=..\..\..\windll\windll.c
+DEP_CPP_WINDL=\
+	"..\..\..\api.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\windll\structs.h"\
+	"..\..\..\windll\windll.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\windll.obj" : $(SOURCE) $(DEP_CPP_WINDL) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+SOURCE=..\..\..\windll\windll.rc
+
+!IF  "$(CFG)" == "zip32 - Win32 Release"
+
+
+"$(INTDIR)\windll.res" : $(SOURCE) "$(INTDIR)"
+	$(RSC) /l 0x409 /fo"$(INTDIR)\windll.res" /i "\temp\zip-232\windll" /d "NDEBUG" /d\
+ "WIN32" $(SOURCE)
+
+
+!ELSEIF  "$(CFG)" == "zip32 - Win32 Debug"
+
+
+"$(INTDIR)\windll.res" : $(SOURCE) "$(INTDIR)"
+	$(RSC) /l 0x409 /fo"$(INTDIR)\windll.res" /i "\temp\zip-232\windll" /d "_DEBUG" /d\
+ "WIN32" $(SOURCE)
+
+
+!ENDIF
+
+SOURCE=..\..\..\zip.c
+
+!IF  "$(CFG)" == "zip32 - Win32 Release"
+
+DEP_CPP_ZIP_C=\
+	"..\..\..\api.h"\
+	"..\..\..\crypt.h"\
+	"..\..\..\revision.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\ttyio.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\windll\structs.h"\
+	"..\..\..\windll\windll.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\zip.obj" : $(SOURCE) $(DEP_CPP_ZIP_C) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ELSEIF  "$(CFG)" == "zip32 - Win32 Debug"
+
+DEP_CPP_ZIP_C=\
+	"..\..\..\api.h"\
+	"..\..\..\crypt.h"\
+	"..\..\..\revision.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\ttyio.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\windll\structs.h"\
+	"..\..\..\windll\windll.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\zip.obj" : $(SOURCE) $(DEP_CPP_ZIP_C) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ENDIF
+
+SOURCE=..\..\..\zipfile.c
+
+!IF  "$(CFG)" == "zip32 - Win32 Release"
+
+DEP_CPP_ZIPFI=\
+	"..\..\..\api.h"\
+	"..\..\..\revision.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\zipfile.obj" : $(SOURCE) $(DEP_CPP_ZIPFI) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ELSEIF  "$(CFG)" == "zip32 - Win32 Debug"
+
+DEP_CPP_ZIPFI=\
+	"..\..\..\api.h"\
+	"..\..\..\revision.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\zipfile.obj" : $(SOURCE) $(DEP_CPP_ZIPFI) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ENDIF
+
+SOURCE=..\..\..\zipup.c
+
+!IF  "$(CFG)" == "zip32 - Win32 Release"
+
+DEP_CPP_ZIPUP=\
+	"..\..\..\api.h"\
+	"..\..\..\crypt.h"\
+	"..\..\..\revision.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\win32\zipup.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\zipup.obj" : $(SOURCE) $(DEP_CPP_ZIPUP) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ELSEIF  "$(CFG)" == "zip32 - Win32 Debug"
+
+DEP_CPP_ZIPUP=\
+	"..\..\..\api.h"\
+	"..\..\..\crypt.h"\
+	"..\..\..\revision.h"\
+	"..\..\..\tailor.h"\
+	"..\..\..\win32\osdep.h"\
+	"..\..\..\win32\zipup.h"\
+	"..\..\..\zip.h"\
+	"..\..\..\ziperr.h"\
+
+
+"$(INTDIR)\zipup.obj" : $(SOURCE) $(DEP_CPP_ZIPUP) "$(INTDIR)"
+	$(CPP) $(CPP_PROJ) $(SOURCE)
+
+
+!ENDIF
+
+
+!ENDIF
+
diff -uNr zip32-2.32.orig/windll/windll.c zip32-2.32/windll/windll.c
--- zip32-2.32.orig/windll/windll.c	1999-11-07 05:58:48.000000000 +0900
+++ zip32-2.32/windll/windll.c	2006-08-09 18:49:02.097483300 +0900
@@ -110,6 +110,7 @@
 
 #define STDIO_BUF_SIZE 16384
 
+#if 0
 int __far __cdecl printf(const char *format, ...)
 {
 va_list argptr;
@@ -170,5 +171,6 @@
 {
 printf(parm1);
 }
+#endif
 
 
diff -uNr zip32-2.32.orig/windll/windll.h zip32-2.32/windll/windll.h
--- zip32-2.32.orig/windll/windll.h	1999-11-07 05:58:54.000000000 +0900
+++ zip32-2.32/windll/windll.h	2006-08-09 19:04:38.315995200 +0900
@@ -55,7 +55,9 @@
 extern LPSTR szCommentBuf;
 extern HANDLE hStr;
 extern HWND hWndMain;
+#if 0
 void __far __cdecl perror(const char *);
+#endif
 
 #endif /* _WINDLL_H */
 
